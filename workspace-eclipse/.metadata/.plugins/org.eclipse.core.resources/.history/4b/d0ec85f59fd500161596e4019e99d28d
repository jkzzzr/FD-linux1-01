package combinAllCollection;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.HashMap;
import java.util.StringTokenizer;

import SplitCollection.Data_doc_uri_index;
import record.ReadFile_10;

public class CombineAllCollection {

	public static synchronized HashMap<String, String> hashMap = new HashMap<>();
	public static void main(String[] args) {

	}
	public void combine(){
		String inputPath = "/media/ClueWeb12_CatB/ClueWeb12_";
		String outputPath = "/home/Lee/data/D1/ClueWeb12_";
		for (int i = 0; i <=19; i++){
			String istr = String.format("%02d", i);
			String tempInput = inputPath + istr;
			String tempoutput = outputPath + istr;
			File outputFile = new File(tempoutput);
			if (!outputFile.exists()){
				outputFile.mkdirs();
			}
			File file = new File(tempInput);
			File[] files = file.listFiles();
			for (File tempf : files){
				
				String en = tempf.getName();

				String input= "";
				input = inputPath+istr+"/"+en;
				
				String output = "";
				output = outputPath+istr+"/"+en;
				File outputFile2 = new File(output);
				if (!outputFile2.exists()){
					try{
					outputFile2.mkdir();
					}catch (Exception e) {
						System.err.println(output);
					}
				}
				.getClass().getName().
			}
		}
	}

	public void run(String inputPath) throws Exception{
		BufferedReader bReader = new BufferedReader(new FileReader(inputPath));
		String line = "";
		while ((line = bReader.readLine())!=null){
			StringTokenizer st = new StringTokenizer(line);
			String uri = st.nextToken();
			String indexString = st.nextToken();
			uri = extract(uri);
			long index = Long.parseLong(indexString);
		}
		
	}
	public String extract(String uri){
		String subURI = uri.substring(0, uri.lastIndexOf("."));
		int index = subURI.lastIndexOf(".");
		//如果是没有点的话，就是-1，那么正好加1
		//如果有的话，那么就应当时点的下表的后面一位开始，所以也是加1
		index ++;
		String returnString = uri.substring(index);
		return returnString;
	}
}
